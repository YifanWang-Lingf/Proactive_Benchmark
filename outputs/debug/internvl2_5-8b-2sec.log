/share2/wangyq/miniconda3_2558/envs/videollm-online/lib/python3.10/site-packages/transformers/utils/hub.py:128: FutureWarning: Using `TRANSFORMERS_CACHE` is deprecated and will be removed in v5 of Transformers. Use `HF_HOME` instead.
  warnings.warn(
ClipTestArguments(
_n_gpu=1,
accelerator_config={'split_batches': False, 'dispatch_batches': None, 'even_batches': True, 'use_seedable_sampler': True, 'non_blocking': False, 'gradient_accumulation_kwargs': None, 'use_configured_state': False},
adafactor=False,
adam_beta1=0.9,
adam_beta2=0.999,
adam_epsilon=1e-08,
attn_implementation=flash_attention_2,
augmentation=False,
auto_find_batch_size=False,
average_tokens_across_devices=False,
batch_eval_metrics=False,
bf16=True,
bf16_full_eval=False,
consecutive_n_frames_threshold=1,
data_seed=None,
dataloader_drop_last=False,
dataloader_num_workers=0,
dataloader_persistent_workers=False,
dataloader_pin_memory=True,
dataloader_prefetch_factor=None,
dataset_config=None,
ddp_backend=None,
ddp_broadcast_buffers=None,
ddp_bucket_cap_mb=None,
ddp_find_unused_parameters=None,
ddp_timeout=1800,
debug=[],
deepspeed=None,
disable_tqdm=False,
dispatch_batches=None,
do_eval=False,
do_predict=False,
do_train=False,
embed_mark=2fps_384_1+3x3,
end_idx=10,
eval_accumulation_steps=None,
eval_delay=0,
eval_do_concat_batches=True,
eval_on_start=False,
eval_steps=None,
eval_strategy=no,
eval_use_gather_object=False,
evaluation_strategy=None,
finetune_modules=['connector', 'mm_projector', 'response_head', 'related_head'],
first_n_frames_no_generate=0,
fp16=False,
fp16_backend=auto,
fp16_full_eval=False,
fp16_opt_level=O1,
frame_fps=2.0,
frame_num_tokens=49,
frame_resolution=384,
frame_token_cls=False,
frame_token_pooled=[7, 7],
fsdp=[],
fsdp_config={'min_num_params': 0, 'xla': False, 'xla_fsdp_v2': False, 'xla_fsdp_grad_ckpt': False},
fsdp_min_num_params=0,
fsdp_transformer_layer_cls_to_wrap=None,
full_determinism=False,
gradient_accumulation_steps=1,
gradient_checkpointing=False,
gradient_checkpointing_kwargs=None,
greater_is_better=None,
grounding_mode=False,
group_by_length=False,
half_precision_backend=auto,
hub_always_push=False,
hub_model_id=None,
hub_private_repo=False,
hub_strategy=every_save,
hub_token=<HUB_TOKEN>,
ignore_data_skip=False,
include_for_metrics=[],
include_inputs_for_metrics=False,
include_num_input_tokens_seen=False,
include_tokens_per_second=False,
input_dir=/share2/wangyq/projects/MMDuet/datasets/shot2story/videos,
is_online_model=True,
jit_mode_eval=False,
label_names=None,
label_smoothing_factor=0.0,
learning_rate=5e-05,
length_column_name=length,
live_version=test,
llm_pretrained=OpenGVLab/InternVL2_5-8B,
load_best_model_at_end=False,
local_rank=0,
log_level=passive,
log_level_replica=warning,
log_on_each_node=True,
logging_dir=outputs/debug/runs/Apr29_13-55-59_ubuntu,
logging_first_step=False,
logging_nan_inf_filter=True,
logging_steps=500,
logging_strategy=steps,
lora_alpha=32,
lora_modules=model\.layers.*(q_proj|k_proj|v_proj|o_proj|gate_proj|up_proj|down_proj)$,
lora_pretrained=None,
lora_r=16,
lr_scheduler_kwargs={},
lr_scheduler_type=linear,
max_grad_norm=1.0,
max_num_frames=400,
max_steps=-1,
metric_for_best_model=None,
mp_parameters=,
need_judge_answerable=1,
neftune_noise_alpha=None,
no_cuda=False,
no_output_before_user_input=False,
num_train_epochs=3.0,
optim=adamw_torch,
optim_args=None,
optim_target_modules=None,
output_dir=outputs/debug,
output_fname=outputs/debug/internvl2_5-8b-2sec.jsonl,
overwrite_output_dir=False,
past_index=-1,
per_device_eval_batch_size=8,
per_device_train_batch_size=8,
prediction_loss_only=False,
push_to_hub=False,
push_to_hub_model_id=None,
push_to_hub_organization=None,
push_to_hub_token=<PUSH_TO_HUB_TOKEN>,
ray_scope=last,
remove_assistant_turns=False,
remove_unused_columns=True,
repetition_penalty=None,
report_to=['tensorboard', 'wandb'],
response_min_interval_frames=None,
restore_callback_states_from_checkpoint=False,
resume_from_checkpoint=None,
run_name=outputs/debug,
running_list_length=20,
save_on_each_node=False,
save_only_model=False,
save_safetensors=True,
save_steps=500,
save_strategy=steps,
save_total_limit=None,
score_heads=informative_score,
seed=42,
skip_memory_metrics=True,
split_batches=None,
start_idx=0,
stream_end_prob_threshold=None,
stream_end_score_sum_threshold=None,
stream_loss_weight=1.0,
system_prompt=A multimodal AI assistant is helping users with some activities. Below is their conversation, interleaved with the list of video frames received by the assistant.,
test_fname=/share2/wangyq/projects/MMDuet/datasets/shot2story/annotations/magqa_test.json,
tf32=None,
threshold_z=None,
time_instruction_format=None,
torch_compile=False,
torch_compile_backend=None,
torch_compile_mode=None,
torch_empty_cache_steps=None,
torchdynamo=None,
tpu_metrics_debug=False,
tpu_num_cores=None,
use_cpu=False,
use_ipex=False,
use_legacy_prediction_loop=False,
use_liger_kernel=False,
use_mps_device=False,
v_placeholder=<image>,
video_chunk_sec=2,
video_pooling_stride=4,
vision_pretrained=google/siglip-large-patch16-384,
warmup_ratio=0.0,
warmup_steps=0,
weight_decay=0.0,
)
A new version of the following files was downloaded from https://huggingface.co/OpenGVLab/InternVL2_5-8B:
- configuration_internvl_chat.py
. Make sure to double-check they do not contain any added malicious code. To avoid downloading new versions of the code file, you can pin a revision.
A new version of the following files was downloaded from https://huggingface.co/OpenGVLab/InternVL2_5-8B:
- modeling_internvl_chat.py
. Make sure to double-check they do not contain any added malicious code. To avoid downloading new versions of the code file, you can pin a revision.
InternLM2ForCausalLM has generative capabilities, as `prepare_inputs_for_generation` is explicitly overwritten. However, it doesn't directly inherit from `GenerationMixin`. From ðŸ‘‰v4.50ðŸ‘ˆ onwards, `PreTrainedModel` will NOT inherit from `GenerationMixin`, and this model will lose the ability to call `generate` and other related functions.
  - If you're using `trust_remote_code=True`, you can get rid of this warning by loading the model with an auto class. See https://huggingface.co/docs/transformers/en/model_doc/auto#auto-classes
  - If you are the owner of the model architecture code, please modify your model class such that it inherits from `GenerationMixin` (after `PreTrainedModel`, otherwise you'll get an exception).
  - If you are not the owner of the model architecture class, please contact the model code owner to update it.
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s]Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:00<00:00,  6.78it/s]Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:00<00:00,  8.09it/s]Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:00<00:00,  8.69it/s]Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:00<00:00,  9.11it/s]Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:00<00:00,  8.68it/s]
A new version of the following files was downloaded from https://huggingface.co/OpenGVLab/InternVL2_5-8B:
- tokenization_internlm2.py
. Make sure to double-check they do not contain any added malicious code. To avoid downloading new versions of the code file, you can pin a revision.
  0%|          | 0/10 [00:00<?, ?it/s]answerable_question: Frame1: <image>
Frame2: <image>
Frame3: <image>
Frame4: <image>
Is the following question answerable by the video? Only reply with Yes or No.
What are people doing in the office?
answerable_response: Yes
question: Frame1: <image>
Frame2: <image>
Frame3: <image>
Frame4: <image>
What are people doing in the office?
response: People in the office are using laptops and watching TV screens. One man is sitting in front of a computer that is on. The video doesn't provide much detail about what they are specifically doing, but it shows them in their office environment, working and moving around the space.
answerable_question: Frame1: <image>
Frame2: <image>
Frame3: <image>
Frame4: <image>
Is the following question answerable by the video? Only reply with Yes or No.
What are people doing in the office?
answerable_response: Yes.
question: Frame1: <image>
Frame2: <image>
Frame3: <image>
Frame4: <image>
What are people doing in the office?
response: People in the office are sitting at their computers, talking to each other, and a man is seen standing in front of the camera.
answerable_question: Frame1: <image>
Frame2: <image>
Frame3: <image>
Frame4: <image>
Is the following question answerable by the video? Only reply with Yes or No.
What are people doing in the office?
answerable_response: Yes
question: Frame1: <image>
Frame2: <image>
Frame3: <image>
Frame4: <image>
What are people doing in the office?
response: People can be seen walking in the office, standing in front of computer screens and working together.
answerable_question: Frame1: <image>
Frame2: <image>
Frame3: <image>
Frame4: <image>
Is the following question answerable by the video? Only reply with Yes or No.
What are people doing in the office?
answerable_response: No
answerable_question: Frame1: <image>
Frame2: <image>
Frame3: <image>
Frame4: <image>
Is the following question answerable by the video? Only reply with Yes or No.
What are people doing in the office?
answerable_response: Yes
question: Frame1: <image>
Frame2: <image>
Frame3: <image>
Frame4: <image>
What are people doing in the office?
response: Some people in the office are talking on the phone, while others can be seen working at desks. One person is also carrying a bag and another is carrying a skateboard by a window.
answerable_question: Frame1: <image>
Frame2: <image>
Frame3: <image>
Frame4: <image>
Is the following question answerable by the video? Only reply with Yes or No.
What are people doing in the office?
answerable_response: Yes
question: Frame1: <image>
Frame2: <image>
Frame3: <image>
Frame4: <image>
What are people doing in the office?
response: People in the office are making phone calls or talking on their phones and computers. There are also people walking through the store.
answerable_question: Frame1: <image>
Frame2: <image>
Frame3: <image>
Frame4: <image>
Is the following question answerable by the video? Only reply with Yes or No.
What are people doing in the office?
answerable_response: Yes
question: Frame1: <image>
Frame2: <image>
Frame3: <image>
Frame4: <image>
What are people doing in the office?
response: The video shows that people are engaged in various activities in the office. Some are using laptops, while others are talking on the phone.
 10%|â–ˆ         | 1/10 [00:15<02:17, 15.26s/it]answerable_question: Frame1: <image>
Frame2: <image>
Frame3: <image>
Frame4: <image>
Is the following question answerable by the video? Only reply with Yes or No.
What activity is taking place in the video?
answerable_response: No.
answerable_question: Frame1: <image>
Frame2: <image>
Frame3: <image>
Frame4: <image>
Is the following question answerable by the video? Only reply with Yes or No.
What activity is taking place in the video?
answerable_response: Yes
question: Frame1: <image>
Frame2: <image>
Frame3: <image>
Frame4: <image>
What activity is taking place in the video?
response: In the video, there is a woman holding on to a man's hand. They are standing on a stage, and it appears that they are performing on the stage together.
answerable_question: Frame1: <image>
Frame2: <image>
Frame3: <image>
Frame4: <image>
Is the following question answerable by the video? Only reply with Yes or No.
What activity is taking place in the video?
answerable_response: Yes.
question: Frame1: <image>
Frame2: <image>
Frame3: <image>
Frame4: <image>
What activity is taking place in the video?
response: It is evident that a man is standing in a boxing ring with his fist up and he is in a fighting stance. It seems that he is a boxer about to engage in a fight.
answerable_question: Frame1: <image>
Frame2: <image>
Frame3: <image>
Frame4: <image>
Is the following question answerable by the video? Only reply with Yes or No.
What activity is taking place in the video?
answerable_response: Yes
question: Frame1: <image>
Frame2: <image>
Frame3: <image>
Frame4: <image>
What activity is taking place in the video?
response: A fight is taking place inside a cage between the two fighters. The video focuses on the fight.
answerable_question: Frame1: <image>
Frame2: <image>
Frame3: <image>
Frame4: <image>
Is the following question answerable by the video? Only reply with Yes or No.
What activity is taking place in the video?
answerable_response: Yes
question: Frame1: <image>
Frame2: <image>
Frame3: <image>
Frame4: <image>
What activity is taking place in the video?
response: The video shows people engaging in sports activities such as wrestling, boxing, and martial arts.
answerable_question: Frame1: <image>
Frame2: <image>
Frame3: <image>
Frame4: <image>
Is the following question answerable by the video? Only reply with Yes or No.
What activity is taking place in the video?
answerable_response: Yes.
question: Frame1: <image>
Frame2: <image>
Frame3: <image>
Frame4: <image>
What activity is taking place in the video?
response: The video shows a man boxing in a ring with another man. They are throwing punches at each other while a crowd watches.
answerable_question: Frame1: <image>
Frame2: <image>
Frame3: <image>
Frame4: <image>
Is the following question answerable by the video? Only reply with Yes or No.
What activity is taking place in the video?
answerable_response: Yes
question: Frame1: <image>
Frame2: <image>
Frame3: <image>
Frame4: <image>
What activity is taking place in the video?
response: A man and woman are fighting each other in the ring. There are no other people or activities shown.
answerable_question: Frame1: <image>
Frame2: <image>
Frame3: <image>
Is the following question answerable by the video? Only reply with Yes or No.
What activity is taking place in the video?
answerable_response: Yes
question: Frame1: <image>
Frame2: <image>
Frame3: <image>
What activity is taking place in the video?
response: There is a boxing match happening in the ring. One boxer is winning the match by kicking the other.
 20%|â–ˆâ–ˆ        | 2/10 [00:26<01:42, 12.83s/it]answerable_question: Frame1: <image>
Frame2: <image>
Frame3: <image>
Frame4: <image>
Is the following question answerable by the video? Only reply with Yes or No.
What are the people doing in the car?
answerable_response: No
answerable_question: Frame1: <image>
Frame2: <image>
Frame3: <image>
Frame4: <image>
Is the following question answerable by the video? Only reply with Yes or No.
What are the people doing in the car?
answerable_response: No
answerable_question: Frame1: <image>
Frame2: <image>
Frame3: <image>
Frame4: <image>
Is the following question answerable by the video? Only reply with Yes or No.
What are the people doing in the car?
answerable_response: Yes
question: Frame1: <image>
Frame2: <image>
Frame3: <image>
Frame4: <image>
What are the people doing in the car?
response: The people in the car are waiting on the side of the road and looking at pictures.
answerable_question: Frame1: <image>
Frame2: <image>
Frame3: <image>
Frame4: <image>
Is the following question answerable by the video? Only reply with Yes or No.
What are the people doing in the car?
answerable_response: Yes
question: Frame1: <image>
Frame2: <image>
Frame3: <image>
Frame4: <image>
What are the people doing in the car?
response: The video shows a young couple with a child in the back seat of a car driving down an empty highway. At one point, the young man is seen driving the car.
answerable_question: Frame1: <image>
Frame2: <image>
Frame3: <image>
Frame4: <image>
Is the following question answerable by the video? Only reply with Yes or No.
What are the people doing in the car?
answerable_response: Yes
question: Frame1: <image>
Frame2: <image>
Frame3: <image>
Frame4: <image>
What are the people doing in the car?
response: In the first part of the video, we see a man and a woman getting into a car and driving down the road. It is not clear if there are any other people in the car or any specific activities that they are doing.
answerable_question: Frame1: <image>
Frame2: <image>
Frame3: <image>
Frame4: <image>
Is the following question answerable by the video? Only reply with Yes or No.
What are the people doing in the car?
answerable_response: Yes
question: Frame1: <image>
Frame2: <image>
Frame3: <image>
Frame4: <image>
What are the people doing in the car?
response: The people are eating food in the car and wearing various clothing items. At certain moments, there are people eating at the table, sitting on a bed, and eating pizza.
answerable_question: Frame1: <image>
Frame2: <image>
Frame3: <image>
Frame4: <image>
Is the following question answerable by the video? Only reply with Yes or No.
What are the people doing in the car?
answerable_response: Yes
question: Frame1: <image>
Frame2: <image>
Frame3: <image>
Frame4: <image>
What are the people doing in the car?
response: The people in the car are eating and singing while driving. We see them enjoying different foods such as pizza, donuts, and chicken. They are holding plates and cutlery.
answerable_question: Frame1: <image>
Frame2: <image>
Frame3: <image>
Is the following question answerable by the video? Only reply with Yes or No.
What are the people doing in the car?
answerable_response: Yes
question: Frame1: <image>
Frame2: <image>
Frame3: <image>
What are the people doing in the car?
response: The people are sitting in the car and looking at a cell phone. One of the people is eating a sandwich.
 30%|â–ˆâ–ˆâ–ˆ       | 3/10 [00:37<01:23, 11.99s/it]answerable_question: Frame1: <image>
Frame2: <image>
Frame3: <image>
Frame4: <image>
Is the following question answerable by the video? Only reply with Yes or No.
What is being cleaned?
answerable_response: Yes
question: Frame1: <image>
Frame2: <image>
Frame3: <image>
Frame4: <image>
What is being cleaned?
response: The video shows a close-up view of toys in a wicker basket, where someone is cleaning a blue pipe.
answerable_question: Frame1: <image>
Frame2: <image>
Frame3: <image>
Frame4: <image>
Is the following question answerable by the video? Only reply with Yes or No.
What is being cleaned?
answerable_response: Yes
question: Frame1: <image>
Frame2: <image>
Frame3: <image>
Frame4: <image>
What is being cleaned?
response: A basket with various toys in it is being brushed in the video.
answerable_question: Frame1: <image>
Frame2: <image>
Frame3: <image>
Frame4: <image>
Is the following question answerable by the video? Only reply with Yes or No.
What is being cleaned?
answerable_response: No.
answerable_question: Frame1: <image>
Frame2: <image>
Frame3: <image>
Frame4: <image>
Is the following question answerable by the video? Only reply with Yes or No.
What is being cleaned?
answerable_response: Yes.
question: Frame1: <image>
Frame2: <image>
Frame3: <image>
Frame4: <image>
What is being cleaned?
response: A small animal or stuffed toy is being cleaned.
answerable_question: Frame1: <image>
Frame2: <image>
Frame3: <image>
Frame4: <image>
Is the following question answerable by the video? Only reply with Yes or No.
What is being cleaned?
answerable_response: Yes
question: Frame1: <image>
Frame2: <image>
Frame3: <image>
Frame4: <image>
What is being cleaned?
response: In the video, the hand holding a piece of fish is being cleaned before being presented to the mouse.
answerable_question: Frame1: <image>
Frame2: <image>
Frame3: <image>
Frame4: <image>
Is the following question answerable by the video? Only reply with Yes or No.
What is being cleaned?
answerable_response: Yes
question: Frame1: <image>
Frame2: <image>
Frame3: <image>
Frame4: <image>
What is being cleaned?
response: The woman is cleaning a glass bottle on a dining table.
answerable_question: Frame1: <image>
Frame2: <image>
Frame3: <image>
Frame4: <image>
Is the following question answerable by the video? Only reply with Yes or No.
What is being cleaned?
answerable_response: Yes
question: Frame1: <image>
Frame2: <image>
Frame3: <image>
Frame4: <image>
What is being cleaned?
response: The dining room table is being cleaned.
answerable_question: Frame1: <image>
Frame2: <image>
Frame3: <image>
Is the following question answerable by the video? Only reply with Yes or No.
What is being cleaned?
answerable_response: Yes.
question: Frame1: <image>
Frame2: <image>
Frame3: <image>
What is being cleaned?
response: The woman is using a piece of cloth to wipe and polish the floors and a wooden table. Additionally, there is a wooden bench that is being cleaned and polished too.
 40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 4/10 [00:46<01:05, 10.99s/it]answerable_question: Frame1: <image>
Frame2: <image>
Frame3: <image>
Frame4: <image>
Is the following question answerable by the video? Only reply with Yes or No.
What event is taking place involving NASA?
answerable_response: Yes
question: Frame1: <image>
Frame2: <image>
Frame3: <image>
Frame4: <image>
What event is taking place involving NASA?
response: A group of people from NASA are seen posing for a picture next to a trophy on a stage.
answerable_question: Frame1: <image>
Frame2: <image>
Frame3: <image>
Frame4: <image>
Is the following question answerable by the video? Only reply with Yes or No.
What event is taking place involving NASA?
answerable_response: Yes
question: Frame1: <image>
Frame2: <image>
Frame3: <image>
Frame4: <image>
What event is taking place involving NASA?
response: A NASA-related event is taking place, where the group of individuals is gathered to present a trophy associated with the agency.
answerable_question: Frame1: <image>
Frame2: <image>
Frame3: <image>
Frame4: <image>
Is the following question answerable by the video? Only reply with Yes or No.
What event is taking place involving NASA?
answerable_response: No
answerable_question: Frame1: <image>
Frame2: <image>
Frame3: <image>
Frame4: <image>
Is the following question answerable by the video? Only reply with Yes or No.
What event is taking place involving NASA?
answerable_response: Yes
question: Frame1: <image>
Frame2: <image>
Frame3: <image>
Frame4: <image>
What event is taking place involving NASA?
response: A NASA event is in session.
answerable_question: Frame1: <image>
Frame2: <image>
Frame3: <image>
Frame4: <image>
Is the following question answerable by the video? Only reply with Yes or No.
What event is taking place involving NASA?
answerable_response: Yes
question: Frame1: <image>
Frame2: <image>
Frame3: <image>
Frame4: <image>
What event is taking place involving NASA?
response: The video depicts a man speaking at a podium with the NASA logo on the front. However, the type of event where the speaker is giving a presentation is not explicitly stated in the video.
answerable_question: Frame1: <image>
Frame2: <image>
Frame3: <image>
Frame4: <image>
Is the following question answerable by the video? Only reply with Yes or No.
What event is taking place involving NASA?
answerable_response: No.
 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 5/10 [00:53<00:47,  9.51s/it] 60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 6/10 [01:01<00:36,  9.02s/it] 70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 7/10 [01:22<00:38, 12.92s/it] 80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 8/10 [01:28<00:21, 10.79s/it] 90%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 9/10 [01:34<00:09,  9.24s/it]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 10/10 [01:42<00:00,  8.75s/it]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 10/10 [01:42<00:00, 10.25s/it]
